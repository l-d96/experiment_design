---
title: Two-sample tests of proportions
author: Lorenzo Drumond
date: 2023-11-14T14:00:43
last: 2023-11-19T21:34:18
zk_id: 20231114140043
tags: #test #rlang #theory #proportions #statistics #design #week2 #coursera #experiment
---


# Two-sample tests of proportions
What if we have more than one sample? And in each sample, we could have more than one response categories. E.g. two different gender groups expressing their preference on the websites A, B and C.

This is the case of two-sample tests of proportions (or n-sample).

Another test that is getting popular is the `G` test, which is also an asymptotic test, which is meant to be more accurate.

An exact test for this kind of scenario is the Fishers' exact test. It was originally developed for 2x2 tests, but can be generalized.

Similarly to before, even if see that there is significant differences in the proportions, we need to run post-hoc tests to determine where they lie.

```R
prefsABCsex = read.csv("prefsABCsex.csv")
View(prefsABCsex)
prefsABCsex$Subject = factor(prefsABCsex$Subject) # convert to nominal factor
prefsABCsex$Pref = factor(prefsABCsex$Pref) # Rv4
prefsABCsex$Sex = factor(prefsABCsex$Sex) # Rv4
summary(prefsABCsex)
plot(prefsABCsex[prefsABCsex$Sex == "M",]$Pref)
plot(prefsABCsex[prefsABCsex$Sex == "F",]$Pref)

# Pearson chi-square test
prfs = xtabs( ~ Pref + Sex, data=prefsABCsex)
View(prfs)
chisq.test(prfs)

# G-test
library(RVAideMemoire)
G.test(prfs)

# Fisher's exact test
fisher.test(prfs)

# manual post hoc binomial tests for (m)ales -- do any prefs for A-C sig. differ from chance for males?
ma = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "M",]$Pref == "A"), nrow(prefsABCsex[prefsABCsex$Sex == "M",]), p=1/3)
mb = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "M",]$Pref == "B"), nrow(prefsABCsex[prefsABCsex$Sex == "M",]), p=1/3)
mc = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "M",]$Pref == "C"), nrow(prefsABCsex[prefsABCsex$Sex == "M",]), p=1/3)
p.adjust(c(ma$p.value, mb$p.value, mc$p.value), method="holm") # correct for multiple comparisons

# manual post hoc binomial tests for (f)emales -- do any prefs for A-C sig. differ from chance for females?
fa = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "F",]$Pref == "A"), nrow(prefsABCsex[prefsABCsex$Sex == "F",]), p=1/3)
fb = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "F",]$Pref == "B"), nrow(prefsABCsex[prefsABCsex$Sex == "F",]), p=1/3)
fc = binom.test(sum(prefsABCsex[prefsABCsex$Sex == "F",]$Pref == "C"), nrow(prefsABCsex[prefsABCsex$Sex == "F",]), p=1/3)
p.adjust(c(fa$p.value, fb$p.value, fc$p.value), method="holm") # correct for multiple comparisons
```

# References
- [[test-of-proportions]]
- [[https://www.coursera.org/learn/designexperiments]]
- [[example-analysis-of-an-ab-test]]
